<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
<title>预约零件</title>
<script type="application/x-javascript">
	
		
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }


</script>
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
<link href="/css/index.css" rel="stylesheet" type="text/css" media="all" />

<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>	
<!--BootStrap Table-->
<link href="https://cdn.staticfile.org/bootstrap-table/1.13.5/bootstrap-table.min.css" rel="stylesheet">
<script src="https://cdn.staticfile.org/bootstrap-table/1.13.5/bootstrap-table.min.js"></script>

</head>
<body>
<<<<<<< HEAD
	<div th:replace="manager/Mnav :: mnavbar"></div> 
=======
	<div th:replace="manager/Mnav :: mnavbar"></div>

>>>>>>> branch 'master' of https://github.com/huangquanhuan/xiuxiuxiu
	<!-- 主体内容：开始 -->
	<div class="services">
		<div class="container">
			<ul id="formTab" class="nav nav-tabs" role="tablist">
				<li class="nav-item"><a class="hvr-underline-from-center"
					data-toggle="tab" href="#table-content">检索预约零件名单</a></li>
				<li><a class="hvr-underline-from-center" data-toggle="tab"
					href="#excel-import">导入预约零件名单</a></li>
			</ul>

			<div class="tab-content">

				<div class="table-responsive tab-pane active" id="table-content">

					<table class="table" id="ViewTable">
                      <caption>预约人员、零件列表</caption>
                    </table>
									<td>
										<button type="button" class="btn btn-primary btn-sm"
											data-toggle="modal"
                      onclick="updateForm('${product}')"
											th:data-target="#detailModal">查看详情</button>


															</div>
															<!-- end panel -->

														</div>
													</div>
												</div>
											</div>
										</div>
									</td>
								</tr>
							</th:block>
						</tbody>
					</table>
				</div>
        <!-- 模态框 -->
                    <div class="modal" th:id="'detailModal" tabindex="-1" role="dialog"
                      aria-labelledby="mySmallModalLabel" aria-hidden="true">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <div class="modal-body">

                            <div class="mid_agile_bannner_top_info">
                              <h2>预约单详情</h2>
                              <div class="heading-underline">
                                <div class="h-u1"></div>
                                <div class="h-u2"></div>
                                <div class="h-u3"></div>
                                <div class="clearfix"></div>
                              </div>

                              <div class="agileits_banner_bottom_left"></div>

                              <div class="row  login-center panel panel-info"
                                th:if="${ reservation!=null}">
                                <div class="panel-heading">
                                <h3 id="applicationTime"></h3>
                                  <!-- <h3 th:if="${reservation.state==0}"
                                    th:text="${'提交时间：'+reservation.applicationTime+'(未受理)'}"></h3>
                                  <h3 th:if="${reservation.state==1}"
                                    th:text="${'提交时间：'+reservation.applicationTime+'(已受理，未完成)'}"></h3>
                                  <h3 th:if="${reservation.state==2}"
                                    th:text="${'提交时间：'+reservation.applicationTime+'(已完成)'}"></h3> -->
                                  <div>
                                    <a th:if="${reservation.state==0}"
                                      th:href="'/editMyReservation?reservationId='+${reservation.id}"
                                      class="btn btn-primary">编辑</a>
                                    <button class="btn btn-danger"
                                      th:if="${reservation.state==0}"
                                      th:onclick="'setTargetID('+${reservation.id}+')'"
                                      data-toggle="modal" data-target="#cancel-data"
                                      type="button">撤销</button>
                                    <button class="btn btn-danger"
                                      th:if="${reservation.state==1}"
                                      th:onclick="'setTargetID('+${reservation.id}+')'"
                                      data-toggle="modal" data-target="#contact-data"
                                      type="button">联系</button>
                                    <button class="btn btn-success"
                                      th:if="${reservation.state==2}"
                                      th:onclick="'setTargetID('+${reservation.id}+')'"
                                      data-toggle="modal" data-target="#remark-data"
                                      type="button">评价</button>
                                    <button class="btn btn-danger"
                                      th:if="${reservation.state==2}"
                                      th:onclick="'setTargetID('+${reservation.id}+')'"
                                      data-toggle="modal" data-target="#feedback-data"
                                      type="button">反馈</button>
                                  </div>
                                </div>

                                <div class="panel-body">

                                  <table class="table" style="table-layout: fixed">
                                    <tbody>
                                      <tr>
                                        <td align="right" width="40%"><h3>维修时间：</h3></td>
                                        <td align="left">
                                          <h3 th:text="${reservation.RequiredTime}"></h3>
                                          <h3 th:text="未填写"
                                            th:if="${reservation.RequiredTime==null || reservation.RequiredTime.length()<1}"></h3>
                                        </td>
                                      </tr>
                                      <tr>
                                        <td align="right"><h3>维修地点：</h3></td>
                                        <td align="left"><h3
                                            th:text="${reservation.place}"></h3></td>
                                      </tr>
                                      <tr>
                                        <td align="right"><h3>维修设备：</h3></td>
                                        <td align="left">
                                          <h3
                                            th:text="${reservation.equipment.equipmentName}"
                                            th:if="${reservation.equipment!=null}"></h3>
                                          <h3 th:text="未选择"
                                            th:if="${reservation.equipment==null}"></h3>
                                        </td>
                                      </tr>
                                      <tr>
                                        <td align="right"><h3>问题类型：</h3></td>
                                        <td align="left"><h3
                                            th:text="${reservation.repairType}">${reservation.repairType}</h3></td>
                                      </tr>
                                      <tr>
                                        <td align="right"><h3>预约零件：</h3></td>
                                        <td align="left">
                                          <h3
                                            th:each="component : ${reservation.componentList}">
                                            <span th:text="${component.name}"></span>
                                          </h3>
                                          <h3 th:text="'未选择'"
                                            th:if="${reservation.componentList.size()<1}"></h3>
                                        </td>
                                      </tr>

                                      <tr>
                                        <td align="right"><h3>问题详情：</h3></td>
                                        <td align="left">
                                          <h3>
                                            <span th:if="${reservation.detail!=null}"
                                              th:text="${reservation.detail}"></span> <span
                                              th:if="${reservation.detail==null || reservation.detail.length()<1}"
                                              th:text="'未填写'"></span>
                                          </h3>
                                        </td>
                                      </tr>
                                      <tr>
                                        <td></td>
                                        <td align="left"><img
                                          th:each="imgUrl : ${reservation.imgUrlList}"
                                          th:src="${imgUrl.img_url}" height="140px" /></td>
                                      </tr>
                                    </tbody>
                                  </table>

                                </div>
                                <!-- end panel-body -->

				<!-- 按钮 -->
				<div class="form-group">
					<div class="col-sm-offset-3 col-sm-9">
						<input type="submit" class="btn btn-primary" value="导出" /> <input
							type="submit" class="btn btn-primary" value="返回" />
					</div>
				</div>
				<div id="excel-import" class="container tab-pane">
					<br />
					<form action="*" method="post">
						<!-- 选择文件 -->
						<div class="form-group">
							<label for="issue-image" class="col-sm-3">选择要导入的excel文件</label>
							<div class="col-sm-9">
								<input id="issue-image" type="file" class="form-control" />
							</div>
						</div>
						<!-- 导入按钮 -->
						<div class="form-group">
							<div class="col-sm-offset-3 col-sm-9">
								<input type="submit" class="btn " value="导入" />
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- js -->
	<!-- password-script -->
	<script type="text/javascript">
		// 		window.onload = function() {
		// 			document.getElementById("password1").onchange = validatePassword;
		// 			document.getElementById("password2").onchange = validatePassword;
		// 		}

		function validatePassword() {
			var pass2 = document.getElementById("password2").value;
			var pass1 = document.getElementById("password1").value;
			if (pass1 != pass2)
				document.getElementById("password2").setCustomValidity(
						"Passwords Don't Match");
			else
				document.getElementById("password2").setCustomValidity('');
			//empty string means no validation error
		}
	</script>
	<!-- //password-script -->

	<!-- //js -->
	<script src="/js/bars.js"></script>
    <script src="https://cdn.staticfile.org/bootstrap-table/1.13.5/locale/bootstrap-table-zh-CN.min.js"></script>
    <script>
    $(document).ready(function () {
        $("#ViewTable").bootstrapTable({
            url:"/reservation/findAll",            //请求地址
            toolbar : '#toolbar',               //工具按钮用哪个容器
            data_local : "zh-US" ,        //表格汉化
            striped : true,           //是否显示行间隔色
            pageNumber : 1,           //初始化加载第一页
            pagination : true,          //是否分页
            sidePagination : 'client',      //server:服务器端分页|client：前端分页
            showToggle:true,				//切换视图
            //minimumCountColumns : 2,            //最少允许的列数
            clickToSelect : true,               //是否启用点击选中行
            sortStable : true,          //是否可排序
            strictSearch : false,               //设置为 true启用 全匹配搜索，否则为模糊搜索
            pageSize : 5,           //单页记录数
            pageList:[5,10,20,'ALL'],    //可选择单页记录数
            search: true,           //表格搜索按钮
            showRefresh : true,         //刷新按钮
            //queryParamsType:'',         //默认值为 'limit' ,在默认情况下 传给服务端的参数为：offset,limit,sort
                              // 设置为 ''  在这种情况下传给服务器的参数为：pageSize,pageNumber
            queryParams : function(params) {  //上传服务器的参数 //params的自带参数类型由queryParamsType决定
                var temp = {
                    offset: params.offset,             //起始
                    limit: params.limit,                         //页面大小
                };
                return temp;
            },
            rowStyle: function (row, index) {
                //这里有5个取值代表5中颜色['active', 'success', 'info', 'warning', 'danger'];
                var strclass = "";
                if (row.state == 2) {
                    strclass = 'success';//还有一个active
                }
                else if (row.state == 1) {
                    strclass = 'warning';
                }
                else if (row.state == 0) {
                    strclass = 'danger';
                }
                else {
                    return {};
                }
                return { classes: strclass }
            }, 
            columns : [ {
                title: '序号',
                field: '',
                align: 'center',
                formatter: function (value, row, index) {
                    return index+1;
                }
            },{
                title : '姓名',
                field : 'student.name',
                align: 'center',
                sortable : true
            },{
              title : '学号',
              field : 'student.studentId',
              align: 'center',
              sortable : true
            },{
              title : '联系电话',
              field : 'student.phoneNumber',
              align: 'center'
            },{
              title : '预约类型',
              field : 'applicationType',
              align: 'center',
              sortable : true,
              formatter: function (value, row, index) {
                    return row.applicationType == 0 ? '活动预约' : '上门服务';
              }
            },{
              title : '场次',
              field : 'requiredTime',
              align: 'center',
              sortable : true,
              formatter: function (value, row, index) {
                  return row.requiredTime+' '+row.place;
              }
            },{
              title : '零件类型',
              field : 'componentList.type',
              align: 'center',
              sortable : true,
              formatter: function (value, row, index) {
            	  var ans='';
            	  for( i in row.componentList) {
            		  ans += ','+ row.componentList[i].type;
            	  }
                  return ans;
              }
            },{
              title : '是否完成',
              align: 'center',
              field : 'state',
              formatter: function (value, row, index) {
                var state;
                if (row.state == 2) {
                  state = '已完成';//还有一个active
                    }
                    else if (row.state == 1) {
                      state = '已受理,未完成';
                    }
                    else if (row.state == 0) {
                      state = '未受理';
                    }
                return state;
                }
            },{
              title : '详情',
              align: 'center',
              field : 'detail',
              events: function(e, value, row, index) {
            	  
              }
              formatter: function (value, row, index) {
                return '<a href="makeReservation?method=getForID&id='+row.id+'" class="view resw3">详情</a>';
              }
            }]
        })
    })
</script>
	<script type="text/javascript" src="/js/jquery.slicebox.js"></script>
	<script type="text/javascript">
		$(function() {
			var Page = (function() {
				var $navArrows = $('#nav-arrows').hide(), $navDots = $(
						'#nav-dots').hide(), $nav = $navDots.children('span'), $shadow = $(
						'#shadow').hide(), slicebox = $('#sb-slider').slicebox(
						{
							onReady : function() {
								$navArrows.show();
								$navDots.show();
								$shadow.show();
							},
							onBeforeChange : function(pos) {
								$nav.removeClass('nav-dot-current');
								$nav.eq(pos).addClass('nav-dot-current');
							}
						}), init = function() {
					initEvents();
				}, initEvents = function() {
					// add navigation events
					$navArrows.children(':first').on('click', function() {
						slicebox.next();
						return false;
					});

					$navArrows.children(':last').on('click', function() {
						slicebox.previous();
						return false;
					});

					$nav.each(function(i) {
						$(this).on('click', function(event) {
							var $dot = $(this);
							if (!slicebox.isActive()) {
								$nav.removeClass('nav-dot-current');
								$dot.addClass('nav-dot-current');
							}
							slicebox.jump(i + 1);
							return false;
						});
					});
				};
				return {
					init : init
				};
			})();
			Page.init();
		});
	</script>
	<script src="/js/waypoints.min.js"></script>
	<script src="/js/counterup.min.js"></script>
	<script>
		jQuery(document).ready(function($) {
			$('.counter').counterUp({
				delay : 10,
				time : 2000
			});
		});
	</script>
	<script type="text/javascript" src="/js/jquery.flexisel.js"></script>
	<script type="text/javascript">
		$(window).load(function() {
			$("#flexiselDemo1").flexisel({
				visibleItems : 4,
				animationSpeed : 1000,
				autoPlay : true,
				autoPlaySpeed : 3000,
				pauseOnHover : true,
				enableResponsiveBreakpoints : true,
				responsiveBreakpoints : {
					portrait : {
						changePoint : 480,
						visibleItems : 1
					},
					landscape : {
						changePoint : 640,
						visibleItems : 2
					},
					tablet : {
						changePoint : 768,
						visibleItems : 2
					}
				}
			});

		});
	</script>
	<script src="/js/jquery.chocolat.js "></script>
	<script src="/js/bootstrap.js"></script>
	<script type="text/javascript" src="/js/move-top.js"></script>
	<script type="text/javascript" src="/js/easing.js"></script>
	<script type="text/javascript">
		jQuery(document).ready(function($) {
			$(".scroll").click(function(event) {
				event.preventDefault();
				$('html,body').animate({
					scrollTop : $(this.hash).offset().top
				}, 1000);
			});
		});
		$(document).ready(function() {
			$().UItoTop({
				easingType : 'easeOutQuart'
			});
		});
	</script>

</body>

</html>