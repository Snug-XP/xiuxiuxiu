<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
<title>预约零件</title>
<script type="application/x-javascript">
	
	
		
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }



</script>
<link href="/css/index.css" rel="stylesheet" type="text/css" media="all" />
<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
<style type="text/css">
.filter {
	display: inline-block;
	margin-right: 1em;
}
</style>
<script
	src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet"
	href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
	<div th:replace="manager/Mnav :: mnavbar"></div>

	<!-- 主体内容：开始 -->
	<div class="services">
		<div class="container">
			<ul id="formTab" class="nav nav-tabs" role="tablist">
				<li class="nav-item"><a class="hvr-underline-from-center"
					data-toggle="tab" href="#table-content">检索预约零件名单</a></li>
				<li><a class="hvr-underline-from-center" data-toggle="tab"
					href="#excel-import">导入预约零件名单</a></li>
			</ul>

			<div class="tab-content">
				<div class="table-responsive tab-pane active" id="table-content">
					<table class="table table-striped table-bordered">
						<p th:text="'零件总数：'+${componentNum}+'  人员总数'+${personNum}"></p>
						<span>零件:<strong th:text="${componentFilter}"
							class="filter"></strong></span>
						<span>场次: <strong th:text="${activityFilter}"
							class="filter"></strong></span>
						<span>状态:<strong th:text="${stateFilter}" class="filter"></strong></span>
						<thead>
							<tr>
								<th>姓名</th>
								<th>学号</th>
								<th>联系电话</th>
								<th>预约类型</th>
								<th>场次</th>
								<th>地点</th>
								<th>零件类型</th>
								<th>是否完成</th>
								<th>操作</th>
								<th>详情</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="reservation,iter1:${reservations}">
								<td th:text="${reservation.student.name}"></td>
								<td th:text="${reservation.student.studentId}"></td>
								<!-- 									<td th:text="${iter1.index}"></td> -->
								<!-- 									<td th:text="${iter2.index}"></td> -->
								<td th:text="${reservation.student.phoneNumber}"></td>

								<td th:if="${reservation.applicationType == 0}">上门预约</td>
								<td th:if="${reservation.applicationType == 1}">活动预约</td>

								<td th:if="${reservation.activity!=null}"
									th:text="${reservation.activity.time}"></td>
								<td th:if="${reservation.activity==null}" th:text="无"></td>
								<td th:if="${reservation.activity!=null}"
									th:text="${reservation.activity.place}"></td>
								<td th:if="${reservation.activity==null}" th:text="无"></td>

								<td th:if="${#lists.size(reservation.componentList)} eq 0" 
									th:text="无"></td>
								<td th:if="${#lists.size(reservation.componentList)} gt 0"
									th:text="${reservation.componentList[0].name}"></td>
								
								<td th:if="${reservation.state == 0}">未受理</td>
								<td th:if="${reservation.state == 1}">处理中</td>
								<td th:if="${reservation.state == 2}">已完成</td>

								<td th:if="${reservation.state == 0}"><a
									th:href="@{/reservation/updateState(id=${reservation.id},state=1)}"
									class="btn btn-info btn-sm">接受</a></td>
								<td th:if="${reservation.state == 1}"><a
									th:href="@{/reservation/updateState(id=${reservation.id},state=2)}"
									class="btn btn-warning btn-sm">标记为完成</a></td>
								<td th:if="${reservation.state == 2}"><a
									class="btn btn-success btn-sm">已完成</a></td>
								<td>
									<button type="button" class="btn btn-primary btn-sm"
										data-toggle="modal"
										th:data-target="'#detailModal'+${iter1.index}">查看详情</button>

									<div class="modal" th:id="'detailModal'+${iter1.index}"
										tabindex="-1" role="dialog"
										aria-labelledby="mySmallModalLabel" aria-hidden="true">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-body">

													<div class="mid_agile_bannner_top_info">
														<h2>预约单详情</h2>
														<div class="heading-underline">
															<div class="h-u1"></div>
															<div class="h-u2"></div>
															<div class="h-u3"></div>
															<div class="clearfix"></div>
														</div>

														<div class="agileits_banner_bottom_left"></div>

														<div class="row  login-center panel panel-info"
															th:if="${ reservation!=null}">
															<div class="panel-heading">
																<h3 th:if="${reservation.state==0}"
																	th:text="${'提交时间：'+reservation.applicationTime+'(未受理)'}"></h3>
																<h3 th:if="${reservation.state==1}"
																	th:text="${'提交时间：'+reservation.applicationTime+'(已受理，未完成)'}"></h3>
																<h3 th:if="${reservation.state==2}"
																	th:text="${'提交时间：'+reservation.applicationTime+'(已完成)'}"></h3>
																<div>
																	<a th:if="${reservation.state==0}"
																		th:href="'/editMyReservation?reservationId='+${reservation.id}"
																		class="btn btn-primary">编辑</a>
																	<button class="btn btn-danger"
																		th:if="${reservation.state==0}"
																		th:onclick="'setTargetID('+${reservation.id}+')'"
																		data-toggle="modal" data-target="#cancel-data"
																		type="button">撤销</button>
																	<button class="btn btn-danger"
																		th:if="${reservation.state==1}"
																		th:onclick="'setTargetID('+${reservation.id}+')'"
																		data-toggle="modal" data-target="#contact-data"
																		type="button">联系</button>
																	<button class="btn btn-success"
																		th:if="${reservation.state==2}"
																		th:onclick="'setTargetID('+${reservation.id}+')'"
																		data-toggle="modal" data-target="#remark-data"
																		type="button">评价</button>
																	<button class="btn btn-danger"
																		th:if="${reservation.state==2}"
																		th:onclick="'setTargetID('+${reservation.id}+')'"
																		data-toggle="modal" data-target="#feedback-data"
																		type="button">反馈</button>
																</div>
															</div>

															<div class="panel-body">

																<table class="table" style="table-layout: fixed">
																	<tbody>
																		<tr>
																			<td align="right" width="40%"><h3>维修时间：</h3></td>
																			<td align="left">
																				<h3 th:text="${reservation.RequiredTime}"></h3>
																				<h3 th:text="未填写"
																					th:if="${reservation.RequiredTime==null || reservation.RequiredTime.length()<1}"></h3>
																			</td>
																		</tr>
																		<tr>
																			<td align="right"><h3>维修地点：</h3></td>
																			<td align="left"><h3
																					th:text="${reservation.place}"></h3></td>
																		</tr>
																		<tr>
																			<td align="right"><h3>维修设备：</h3></td>
																			<td align="left">
																				<h3 th:text="${reservation.equipment.equipmentName}"
																					th:if="${reservation.equipment!=null}"></h3>
																				<h3 th:text="未选择"
																					th:if="${reservation.equipment==null}"></h3>
																			</td>
																		</tr>
																		<tr>
																			<td align="right"><h3>问题类型：</h3></td>
																			<td align="left"><h3
																					th:text="${reservation.repairType}">${reservation.repairType}</h3></td>
																		</tr>
																		<tr>
																			<td align="right"><h3>预约零件：</h3></td>
																			<td align="left">
																				<h3
																					th:each="component : ${reservation.componentList}">
																					<span th:text="${component.name}"></span>
																				</h3>
																				<h3 th:text="'未选择'"
																					th:if="${reservation.componentList.size()<1}"></h3>
																			</td>
																		</tr>

																		<tr>
																			<td align="right"><h3>问题详情：</h3></td>
																			<td align="left">
																				<h3>
																					<span th:if="${reservation.detail!=null}"
																						th:text="${reservation.detail}"></span> <span
																						th:if="${reservation.detail==null || reservation.detail.length()<1}"
																						th:text="'未填写'"></span>
																				</h3>
																			</td>
																		</tr>
																		<tr>
																			<td></td>
																			<td align="left"><img
																				th:each="imgUrl : ${reservation.imgUrlList}"
																				th:src="${imgUrl.img_url}" height="140px" /></td>
																		</tr>
																	</tbody>
																</table>

															</div>
															<!-- end panel-body -->

														</div>
														<!-- end panel -->

													</div>
												</div>
											</div>
										</div>
									</div>
								</td>
								</th:block>
						</tbody>
					</table>
				</div>
				<!-- 按钮 -->
				<div class="form-group">
					<div class="col-sm-offset-3 col-sm-9">
						<input type="submit" class="btn btn-primary" value="导出" /> <input
							type="submit" class="btn btn-primary" value="返回" />
					</div>
				</div>
				<div id="excel-import" class="container tab-pane">
					<br />
					<form action="*" method="post">
						<!-- 选择文件 -->
						<div class="form-group">
							<label for="issue-image" class="col-sm-3">选择要导入的excel文件</label>
							<div class="col-sm-9">
								<input id="issue-image" type="file" class="form-control" />
							</div>
						</div>
						<!-- 导入按钮 -->
						<div class="form-group">
							<div class="col-sm-offset-3 col-sm-9">
								<input type="submit" class="btn " value="导入" />
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- js -->
	<script type="text/javascript" src="/js/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="/js/modernizr.custom.46884.js"></script>
	<!-- password-script -->
	<script type="text/javascript">
		// 		window.onload = function() {
		// 			document.getElementById("password1").onchange = validatePassword;
		// 			document.getElementById("password2").onchange = validatePassword;
		// 		}

		function validatePassword() {
			var pass2 = document.getElementById("password2").value;
			var pass1 = document.getElementById("password1").value;
			if (pass1 != pass2)
				document.getElementById("password2").setCustomValidity(
						"Passwords Don't Match");
			else
				document.getElementById("password2").setCustomValidity('');
			//empty string means no validation error
		}
	</script>
	<!-- //password-script -->

	<!-- //js -->
	<script src="/js/bars.js"></script>

	<script type="text/javascript" src="/js/jquery.slicebox.js"></script>
	<script type="text/javascript">
		$(function() {
			var Page = (function() {
				var $navArrows = $('#nav-arrows').hide(), $navDots = $(
						'#nav-dots').hide(), $nav = $navDots.children('span'), $shadow = $(
						'#shadow').hide(), slicebox = $('#sb-slider').slicebox(
						{
							onReady : function() {
								$navArrows.show();
								$navDots.show();
								$shadow.show();
							},
							onBeforeChange : function(pos) {
								$nav.removeClass('nav-dot-current');
								$nav.eq(pos).addClass('nav-dot-current');
							}
						}), init = function() {
					initEvents();
				}, initEvents = function() {
					// add navigation events
					$navArrows.children(':first').on('click', function() {
						slicebox.next();
						return false;
					});

					$navArrows.children(':last').on('click', function() {
						slicebox.previous();
						return false;
					});

					$nav.each(function(i) {
						$(this).on('click', function(event) {
							var $dot = $(this);
							if (!slicebox.isActive()) {
								$nav.removeClass('nav-dot-current');
								$dot.addClass('nav-dot-current');
							}
							slicebox.jump(i + 1);
							return false;
						});
					});
				};
				return {
					init : init
				};
			})();
			Page.init();
		});
	</script>
	<script src="/js/waypoints.min.js"></script>
	<script src="/js/counterup.min.js"></script>
	<script>
		jQuery(document).ready(function($) {
			$('.counter').counterUp({
				delay : 10,
				time : 2000
			});
		});
	</script>
	<script type="text/javascript" src="/js/jquery.flexisel.js"></script>
	<script type="text/javascript">
		$(window).load(function() {
			$("#flexiselDemo1").flexisel({
				visibleItems : 4,
				animationSpeed : 1000,
				autoPlay : true,
				autoPlaySpeed : 3000,
				pauseOnHover : true,
				enableResponsiveBreakpoints : true,
				responsiveBreakpoints : {
					portrait : {
						changePoint : 480,
						visibleItems : 1
					},
					landscape : {
						changePoint : 640,
						visibleItems : 2
					},
					tablet : {
						changePoint : 768,
						visibleItems : 2
					}
				}
			});

		});
	</script>
	<script src="/js/jquery.chocolat.js "></script>
	<script src="/js/bootstrap.js"></script>
	<script type="text/javascript" src="/js/move-top.js"></script>
	<script type="text/javascript" src="/js/easing.js"></script>
	<script type="text/javascript">
		jQuery(document).ready(function($) {
			$(".scroll").click(function(event) {
				event.preventDefault();
				$('html,body').animate({
					scrollTop : $(this.hash).offset().top
				}, 1000);
			});
		});
		$(document).ready(function() {
			$().UItoTop({
				easingType : 'easeOutQuart'
			});
		});
	</script>

</body>

</html>